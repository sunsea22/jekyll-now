---
layout: post
title: shell学习
---

shell脚本编程


   接触shell编程不久，对一些关于shell编程的面试题做一些整理

### 从a.log文件中提取包含”WARNING“或“FATAL”，同时不包含“IGNOR”的行，然后，提取以“：”分割的第五个字段？
```javascript
   grep -E 'WARNING|FATAL' a.log | grep -v 'IGNOR' | awk -F : '{print $5 }'	
```

### 添加一个新组为class01，然后，添加属于这个组的30个用户，用户名的形式为stdXX，其中，XX从01到30？
```javascript
#!/bin/bash
   groupadd class01
   for((i=1;i<=9;i++))
   do
        useradd std0$i -G class01
   done

   for((i=10;i<=30;i++))
   do
        useradd std$i -G class01
   done

```

### 在每个月的第一天备份并压缩/etc目录下的所有内容，存放在/root/backup目录里，且文件名为如下形式yymmdd_etc，yy为年，dd为日。shell程序fileback存放在/usr/bin目录下？
```javascript
tar -zcf /root/backup/'date+%y%m%d'_etc /etc
```

### 用shell编程，判断一个文件是不是字符设备文件，如果是将其拷贝到/dev目录下？
```javascript
#!/bin/bash
if test$# -nel
then
     echo "ERROR"
     exit 1
fi
if test -c $1
then 
      /bin/cp -a $1 /dev/
      exit 0
fi
  exit 1
```

#### `cp -a`的用法
对于`cp -a`最主要的用法是在保留原文件属性的前提下复制文件。

其实还有个很好的用法，如下：
大家都知道linux下复制目录可以通过`cp -r dirname destdir`
但是这样复制的目录属性会发生变化，想要使得复制之后的目录和源目录完全一样，可以使用`cp -a dirname destdir`

#### test命令用法
```javascript
test -n 字符串 字符串的长度非零
test -z 字符串 字符串的长度为零
test File1 -ef File2 两个文件具有同样的设备号和i结点号
test File1 -nt File2 文件1比文件2新
test File1 -ot File2 文件1比文件2旧
test -b File 文件存在并且是块设备文件
test -c File 文件存在并且是字符设备文件
test -d File 文件存在并且是目录
```

### 某系统管理员需要每天做一定的重复工作，编制一个解决方案：
(1)从下午4：50删除/abc目录下的全部子目录和全部文件;
(2)从早上8：00~下午6：00每小时读取/xyz目录下x1文件中每行第一个域的全部数据加入到/backup目录下的back01.txt文件内；
(3)每逢周一下午5：50将/data目录下的所有目录和文件归档并压缩为文件backup.tar.gz;
(4)在下午5：55将IDE接口的CD-ROM卸载（假设CD-ROM的设备名为hdc）；
(5)在早上8：00开机后启动

使用计划任务来完成：
```javascript
crontab -e
-----------------------
50 16 * * * rm -rf /abc/*
00 08-18 * * * awk '{print$1 }' /xyz/x1 >> /backup/back01.txt
50 17 * * 01 tar -zcf /backup/backup.tar.gz /data
55 17 * * * umout /dev/hdc
-----------------------
设定BIOS每日上午08：00开机
```



----
****
